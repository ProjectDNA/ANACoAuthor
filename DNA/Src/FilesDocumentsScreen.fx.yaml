FilesDocumentsScreen As screen:
    Fill: =If(DarkMode,Dark3,White1)

    Files_FileSearchPaginationSelector As PaginationSelector:
        Visible: =false
        Y: =1056

    Files_MainHeader As MainHeader:
        PersonalImage: =currPersonnelImage
        PersonalInfoScreen: =PersonalInfoScreen
        ZIndex: =2

    Files_MenuLowerHeader As MenuLowerHeader:
        BackScreen: =DashboardScreen
        LowerMenuTextLabel: =__localizer.Localize("ANA_SPLASH_LABEL_FILES_AND_DOCS", LangEn)
        Y: =Files_MainHeader.Height
        ZIndex: =3

    "Files_FileMainGalleryStyle As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
        Fill: =RGBA(237, 237, 237, 0)
        Height: =956
        Items: |-
            =Search(
                Filter(
                    Documents, 
                    Text(FileType) = Files_AdvancedSearchFileTypeSelector.SelectedText.Value
                ), 
                Files_SearchInput.SearchText, 
                "wywm_filename"
            )
        Layout: =Layout.Vertical
        TemplatePadding: =0
        TemplateSize: =231
        Visible: =!_FileViewDetailed
        Y: =180
        ZIndex: =4

        Files_GalleryDescription As label:
            Color: =If(DarkMode,White1,Dark1)
            Height: =86
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =20
            PaddingRight: =20
            PaddingTop: =0
            Text: =If(LangEn, ThisItem.Description, ThisItem.'Description FR')
            VerticalAlign: =VerticalAlign.Top
            Width: =640
            Y: =94
            ZIndex: =4

        Files_GalleryShareButton As image:
            Fill: =If(DarkMode,Dark4,Blue2)
            Height: =48
            Image: =share_white_48dp
            OnSelect: |-
                =Launch( 
                    Concatenate("mailto:?",
                        "subject=2DIV ANA File: ", EncodeUrl(Text(ThisItem.File.FileName)), 
                        "&body=","Hey check out this document from the 2DIV ANA app.  Filename: ",
                        EncodeUrl("https://apps.powerapps.com/play/c4f8953d-dda1-41a2-b152-9231048da4e3?tenantId=c56878cd-12aa-432b-8025-25669942b9cc&filename="
                            & ThisItem.File.FileName),
                        "%0A%0A"
                    )
                )
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Width: =48
            X: =14
            Y: =165
            ZIndex: =5

        Files_GalleryButton As button:
            Color: =If(DarkMode,Dark4,Blue2)
            Fill: =RGBA(0, 0, 0, 0)
            Height: =Files_GalleryFileName.Height
            HoverFill: =
            OnSelect: |-
                =Navigate(DocumentDetailScreen, ScreenTransition.CoverRight, { SelectedFile: ThisItem, DocumentLoaded: false })
            Size: =24
            Text: =""
            Width: =Files_GalleryFileName.Width
            X: =Files_GalleryFileName.X
            Y: =Files_GalleryFileName.Y
            ZIndex: =7

        Files_DocumentGroup As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =12

            Files_GalleryFileNameNice As label:
                Color: =RGBA(255, 255, 255, 1)
                Fill: =If(DarkMode,Dark4,Blue1)
                Font: =Font.Lato
                Height: =79
                OnSelect: |-
                    =Navigate(DocumentDetailScreen, ScreenTransition.CoverRight, { SelectedFile: ThisItem })
                PaddingBottom: =10
                PaddingLeft: =80
                PaddingRight: =10
                PaddingTop: =10
                Size: =18
                Text: =If(LangEn, ThisItem.Filename, ThisItem.'Filename FR')
                VerticalAlign: =VerticalAlign.Top
                Width: =Parent.Width
                ZIndex: =1

            Files_GalleryFileName As label:
                Color: =RGBA(56, 96, 178, 1)
                Height: =55
                OnSelect: |-
                    =Navigate(DocumentDetailScreen, ScreenTransition.CoverRight, { SelectedFile: ThisItem })
                PaddingBottom: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.File.FileName
                Underline: =true
                Width: =466
                Wrap: =false
                X: =105
                Y: =162
                ZIndex: =2

            Files_GalleryFileTypeIcon As image:
                Fill: =If(DarkMode,Dark4,Blue2)
                Height: =48
                Image: |
                    =Switch(ThisItem.FileType,
                        FileType.PDF, picture_as_pdf_white_48dp,
                        FileType.Image, image_white_48dp,
                        FileType.Link, link_white_48dp,
                        warning_white_48dp
                    )
                        
                OnSelect: |-
                    =Navigate(DocumentDetailScreen, ScreenTransition.CoverRight, { SelectedFile: ThisItem })
                Width: =48
                X: =14
                Y: =11
                ZIndex: =6

    Files_ShowSearchIcon As icon.Add:
        Color: =RGBA(255, 255, 255, 1)
        ContentLanguage: =
        Height: =48
        Icon: =Icon.Search
        OnSelect: =//Set(SearchMenuVisible, !SearchMenuVisible)
        Visible: =false
        Width: =48
        X: =574
        Y: =110
        ZIndex: =5

    Files_FileSearchToggleView As icon.Add:
        Color: =RGBA(255, 255, 255, 1)
        Height: =48
        Icon: =Icon.Filter
        OnSelect: =Set(_FileViewDetailed, !_FileViewDetailed);
        Visible: =false
        Width: =48
        X: =506
        Y: =111
        ZIndex: =6

    Files_NoResultsFound As NoResultsLabel:
        Height: =876
        Visible: =CountRows(Files_FileMainGalleryStyle.AllItems) <= 0
        Y: =180
        ZIndex: =7

    Files_FileSearchGroup As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =25

        Files_DismissSearchBackground As rectangle:
            Fill: =RGBA(0, 0, 0, 0)
            Height: =1135
            OnSelect: =Set(SearchMenuVisible, false)
            Visible: =SearchMenuVisible
            Width: =640
            Y: =1
            ZIndex: =9

        Files_AdvancedSearchBackground As rectangle:
            Fill: =RGBA(0, 0, 0, 0.89)
            Height: =640
            Visible: =SearchMenuVisible
            Width: =640
            Y: =Files_MenuLowerHeader.Y
            ZIndex: =10

        Files_AdvancedSearchFileTypeSelector As dropdown:
            DisplayMode: |-
                =If(Files_AdvancedSearchFilterByFileLabel.IsToggled = true,
                    DisplayMode.Edit,
                    DisplayMode.Disabled
                )
            Items: =[ FileType.PDF, FileType.Link, FileType.Image ]
            Size: =21
            Visible: =SearchMenuVisible && Files_AdvancedSearchCollapsibleLabel.IsCollapsed
            Width: =234
            X: =236
            Y: =588
            ZIndex: =11

        Files_AdvancedSearchFileType As label:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: |-
                =If(Files_AdvancedSearchFilterByFileLabel.IsToggled = true,
                    DisplayMode.Edit,
                    DisplayMode.Disabled
                )
            Height: =41
            Size: =18
            Text: =__localizer.Localize("ANA_FILEDOC_FILE_TYPE", LangEn)
            Visible: =SearchMenuVisible && Files_AdvancedSearchCollapsibleLabel.IsCollapsed
            Width: =175
            X: =50
            Y: =587
            ZIndex: =12

        Files_AdvancedSearchEndDatePicker As datepicker:
            DisplayMode: |-
                =If(Files_AdvancedSearchFilterByDateLabel.IsToggled = true,
                    DisplayMode.Edit,
                    DisplayMode.Disabled
                )
            Height: =38
            Size: =24
            Visible: =SearchMenuVisible && Files_AdvancedSearchCollapsibleLabel.IsCollapsed
            Width: =234
            X: =236
            Y: =443
            ZIndex: =13

        Files_AdvancedSearchEndDate As label:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: |-
                =If(Files_AdvancedSearchFilterByDateLabel.IsToggled = true,
                    DisplayMode.Edit,
                    DisplayMode.Disabled
                )
            Height: =38
            Size: =18
            Text: =__localizer.Localize("ANA_FILEDOC_END_DATE", LangEn)
            Visible: =SearchMenuVisible && Files_AdvancedSearchCollapsibleLabel.IsCollapsed
            Width: =161
            X: =50
            Y: =437
            ZIndex: =14

        Files_AdvancedSearchStartDatePicker As datepicker:
            DisplayMode: |-
                =If(Files_AdvancedSearchFilterByDateLabel.IsToggled = true,
                    DisplayMode.Edit,
                    DisplayMode.Disabled
                )
            Height: =38
            Size: =24
            Visible: =SearchMenuVisible && Files_AdvancedSearchCollapsibleLabel.IsCollapsed
            Width: =234
            X: =236
            Y: =385
            ZIndex: =15

        Files_AdvancedSearchStartDate As label:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: |-
                =If(Files_AdvancedSearchFilterByDateLabel.IsToggled = true,
                    DisplayMode.Edit,
                    DisplayMode.Disabled
                )
            Height: =38
            Size: =18
            Text: =__localizer.Localize("ANA_FILEDOC_START_DATE", LangEn)
            Visible: =SearchMenuVisible && Files_AdvancedSearchCollapsibleLabel.IsCollapsed
            Width: =175
            X: =50
            Y: =385
            ZIndex: =16

        Files_AdvancedSearchCollapsibleLabel As CollapsibleLabel:
            Text: =__localizer.Localize("ANA_FILEDOC_ADVANCED_SEARCH", LangEn)
            Visible: =SearchMenuVisible
            Y: =180
            ZIndex: =17

        Files_AdvancedSearchFilterByDateLabel As ToggleLabel:
            Text: =__localizer.Localize("ANA_FILEDOC_FILTER_BY_DATE", LangEn)
            UnderlineColor: =RGBA(184, 0, 0, 1)
            Visible: =SearchMenuVisible && Files_AdvancedSearchCollapsibleLabel.IsCollapsed
            Y: =260
            ZIndex: =18

        Files_AdvancedSearchFilterByFileLabel As ToggleLabel:
            Text: =__localizer.Localize("ANA_FILEDOC_BY_TYPE", LangEn)
            UnderlineColor: =RGBA(184, 0, 0, 1)
            Visible: =SearchMenuVisible && Files_AdvancedSearchCollapsibleLabel.IsCollapsed
            Y: =490
            ZIndex: =19

        Files_SearchInput As SearchInput:
            Visible: =SearchMenuVisible
            Y: =110
            ZIndex: =20

        Files_AdvancedSearchDismissButton As button:
            BorderColor: =Yellow1
            BorderThickness: =0
            Fill: =Blue2
            Height: =47
            OnSelect: =Set(SearchMenuVisible, false)
            Size: =18
            Text: =__localizer.Localize("ANA_FILEDOC_DISMISS", LangEn)
            Visible: =SearchMenuVisible && Files_AdvancedSearchCollapsibleLabel.IsCollapsed
            Width: =152
            X: =475
            Y: =666
            ZIndex: =21

